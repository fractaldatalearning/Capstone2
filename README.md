# Instacart Recommendations 

![shopping cart filling automatically](data:image/jpeg;base64,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)

My goal in this project is to determine which items instacart should recommend to each user next time they log into their account (based on predictions of what they'll reorder from items purchased in the past). 

Dataset originated here: https://www.kaggle.com/competitions/instacart-market-basket-analysis/overview

My [summative project report is available here](https://github.com/fractaldatalearning/Capstone2/blob/main/reports/Katin_Capstone2_Report.pdf), or read a summary below to understand what can be found in which notebook:

1. In the [wrangling notebook](https://github.com/fractaldatalearning/Capstone2/blob/main/notebooks/1-kl-wrangling.ipynb), I load data and merge data about products with that about users and their orders. 

2. Exploratory data analysis begins in [notebook 2](https://github.com/fractaldatalearning/Capstone2/blob/main/notebooks/2-kl-eda-w-data-direct-from-wrangling.ipynb) but continues all the way through notebook 6, as more insights about the data become possible after some features are engineered. Specifically, in notebooks [3](https://github.com/fractaldatalearning/Capstone2/blob/main/notebooks/3-kl-eda-w-single-user.ipynb) and [4](https://github.com/fractaldatalearning/Capstone2/blob/main/notebooks/4-kl-eda-modeling-w-single-user.ipynb), I explore in-depth one single user's purchasing and re-ordering habits in order to deeply understand factors that might support accurate predictions of items they will reorder in the future. 

3. Notebooks [5.1](https://github.com/fractaldatalearning/Capstone2/blob/main/notebooks/5.1-kl-preprocess-select-users-add-rows.ipynb) and [5.2](https://github.com/fractaldatalearning/Capstone2/blob/main/notebooks/5.2-kl-preprocess-get-usable-data.ipynb) are dedicated to the most crucial step of **adding non-ordered items** to each order by each user. This spans two notebooks only because the size of the dataset was slowing down my work in the first. This is such a crucial step because the raw data came with only information about items a user actually purchased in each order. In order to make predictions about what a user will re-order in their 100th order, for example, we need to know, from their 99th order, which items they reordered AND *did not* reorder from among all items they ever ordered. This required creating new rows such that the size of each order grew cumulatively over time for each user, and this resulted in a dataframe with approxiimately 15 times as many rows as the raw set.  

4. I had the most fun with [notebook 6](https://github.com/fractaldatalearning/Capstone2/blob/main/notebooks/6-kl-preprocess-feature-engineer.ipynb), where I engineered several new features. For example, for each item in each order, I added a column to indicate the **percentage of past orders where that item had been purchased**. Other new features included "percent of past orders where this product was one of the first 6 items placed in this user's cart" and product kewords such as "organic" or "fresh." These improve modeling because "percent of past orders where this item was purchased," for example, is highly correlated with whether an item will be reordered again in the future, but until the feature was engineered, a model would have had no way to pcik up on this valuable variable. 

5. In [notebook 7](https://github.com/fractaldatalearning/Capstone2/blob/main/notebooks/7-kl-preprocess-encoding.ipynb), I tried multiple strategies for encoding categorical data and chose a **Target Encoder** with default hyperparameters in order to encode categorical features such as the user id, product name, and aisle and department in which each product is classified. 

6. Finally, in [notebook 8](https://github.com/fractaldatalearning/Capstone2/blob/main/notebooks/8-kl-modeling.ipynb), I use a random grid search with cross-validation to test multiple classifiers. I selected the **Random Forest classifier** becaue it performed best overall in a combined evaluation using log loss, roc_auc, and f1 metrics. I tuned the hyperparameters and finalized the model. 

<p><small>Project based on the <a target="_blank" href="https://drivendata.github.io/cookiecutter-data-science/">cookiecutter data science project template</a>. #cookiecutterdatascience</small></p>
